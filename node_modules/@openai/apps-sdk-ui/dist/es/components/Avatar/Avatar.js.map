{"version":3,"file":"Avatar.js","sourceRoot":"","sources":["../../../../src/components/Avatar/Avatar.tsx"],"names":[],"mappings":"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","sourcesContent":["\"use client\"\n\nimport clsx from \"clsx\"\nimport { useMemo, useState } from \"react\"\nimport { toCssVariables } from \"../../lib/helpers\"\nimport { type SemanticColors, type Variants } from \"../../types\"\nimport s from \"./Avatar.module.css\"\n\ntype ImageStatus = undefined | \"error\" | \"loaded\"\n\nexport type AvatarProps = {\n  /** Class name applied to the avatar */\n  className?: string\n  /** Size of the avatar's width & height, in pixels. */\n  size?: number\n  /** Display a formatted count of overflow objects. */\n  overflowCount?: number\n  /** Name used to display initials from */\n  name?: string\n  /**\n   * Color used for the avatar\n   * @default secondary\n   */\n  color?: SemanticColors<\"primary\" | \"secondary\" | \"success\" | \"info\" | \"discovery\" | \"danger\">\n  /**\n   * Style variant of the avatar\n   * @default soft\n   */\n  variant?: Variants<\"soft\" | \"solid\">\n  /** URL of the image to display as the avatar */\n  imageUrl?: string\n  /** Icon to render in the avatar circle */\n  Icon?: React.ComponentType<React.SVGProps<SVGSVGElement>>\n  /** Optional click handler, which also enables semantic interactions */\n  onClick?: () => void\n  /** Optional pointer handler, which also enables semantic interactions */\n  onPointerDown?: () => void\n}\n\nexport const Avatar = (props: AvatarProps) => {\n  // Validate the image url before sending to the component\n  const validImageUrl = validateImageUrl(props.imageUrl)\n\n  // Keying off of imageUrl allows us to refresh imageStatus automatically through React rendering\n  return <AvatarInner {...props} imageUrl={validImageUrl} key={validImageUrl} />\n}\n\nexport const AvatarInner = (props: AvatarProps) => {\n  const {\n    className,\n    size,\n    overflowCount,\n    name,\n    color = \"secondary\",\n    variant = \"soft\",\n    imageUrl,\n    Icon,\n    // asChild support\n    ...restProps\n  } = props\n  const [imageStatus, setImageStatus] = useState<ImageStatus>()\n  const isInteractive = !!(restProps.onPointerDown || restProps.onClick)\n  const TagName = isInteractive ? \"button\" : \"span\"\n\n  return (\n    <TagName\n      className={clsx(s.Avatar, className)}\n      style={toCssVariables({\n        \"avatar-size\": size,\n      })}\n      role={isInteractive ? undefined : \"presentation\"}\n      data-color={color}\n      data-variant={variant}\n      type={isInteractive ? \"button\" : undefined}\n      {...restProps}\n    >\n      {(() => {\n        if (imageUrl && imageStatus !== \"error\") {\n          return (\n            <AvatarImage\n              status={imageStatus}\n              url={imageUrl}\n              onError={() => setImageStatus(\"error\")}\n              onLoad={() => setImageStatus(\"loaded\")}\n            />\n          )\n        }\n        if (Icon) {\n          return <Icon className={s.AvatarIcon} />\n        }\n        return overflowCount ? (\n          <AvatarOverflowCount count={overflowCount} />\n        ) : (\n          <AvatarInitial name={name} />\n        )\n      })()}\n    </TagName>\n  )\n}\n\nconst validateImageUrl = (imageUrl?: string): string | undefined => {\n  if (!imageUrl) {\n    return\n  }\n\n  // Avoid specific pattern of images from gravatar.com, which use a pair of initials, instead of a single initial.\n  if (imageUrl.includes(\"gravatar.com\") && imageUrl.includes(\"cdn.auth0.com\")) {\n    return\n  }\n\n  return imageUrl\n}\n\nconst AvatarImage = ({\n  url,\n  status,\n  onLoad,\n  onError,\n}: {\n  url: string\n  status: ImageStatus\n  onLoad: () => void\n  onError: () => void\n}) => {\n  return (\n    <span className={s.AvatarImageContainer}>\n      <img\n        src={url}\n        className={s.AvatarImage}\n        data-loaded={status === \"loaded\" ? \"\" : undefined}\n        onLoad={onLoad}\n        onError={onError}\n        alt=\"\"\n        role=\"presentation\"\n      />\n    </span>\n  )\n}\n\nconst AvatarInitial = ({ name = \"\" }: { name?: string }) => {\n  const firstInitial = useMemo(() => name.charAt(0).toUpperCase(), [name])\n\n  return <span className={s.AvatarInitial}>{firstInitial}</span>\n}\n\nconst AvatarOverflowCount = ({ count }: { count: number }) => {\n  const formattedCount = useMemo<string>(() => {\n    return new Intl.NumberFormat(\"en\", {\n      notation: \"compact\",\n      compactDisplay: \"short\",\n      maximumFractionDigits: 0,\n    })\n      .format(count)\n      .toLocaleLowerCase()\n  }, [count])\n\n  return (\n    <span className={s.AvatarOverflowCount} data-letter-count={formattedCount.length}>\n      <span className={s.AvatarOverflowCountSymbol}>+</span>\n      {formattedCount}\n    </span>\n  )\n}\n"]}