{"version":3,"file":"SelectControl.js","sourceRoot":"","sources":["../../../../src/components/SelectControl/SelectControl.tsx"],"names":[],"mappings":"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","sourcesContent":["\"use client\"\n\nimport clsx from \"clsx\"\nimport { useRef, type ReactNode } from \"react\"\nimport { mergeRefs } from \"react-merge-refs\"\nimport { handlePressableMouseEnter } from \"../../lib/helpers\"\nimport type { ControlSize, Variants } from \"../../types\"\nimport { Button } from \"../Button\"\nimport { ChevronDownVector, DropdownVector, X } from \"../Icon\"\nimport { LoadingIndicator } from \"../Indicator\"\nimport s from \"./SelectControl.module.css\"\n\nexport type DropdownIconType = \"chevronDown\" | \"dropdown\" | \"none\"\n\nexport type SelectControlProps = Omit<React.HTMLAttributes<HTMLSpanElement>, \"onClick\"> & {\n  /**\n   * Style variant for the Button\n   * @default fill\n   */\n  variant?: Variants<\"soft\" | \"outline\" | \"ghost\">\n  /**\n   * Determines if the control should be a fully rounded pill shape\n   * @default false\n   */\n  pill?: boolean\n  /**\n   * Extends the control to 100% of available width.\n   * @default true\n   */\n  block?: boolean\n  /**\n   * Applies a negative margin using the current gutter to optically align the control\n   * with surrounding content.\n   */\n  opticallyAlign?: \"start\" | \"end\"\n  /**\n   * Disables the control visually and from interactions\n   * @default false\n   */\n  disabled?: boolean\n  /**\n   * Visually indicates that the control is in an invalid state\n   * @default false\n   */\n  invalid?: boolean\n  /**\n   * Indicates that the control is selected. An unselected state will display placeholder styles.\n   * @default false\n   */\n  selected?: boolean\n  /**\n   * Display a clear action that allows the select to be unset.\n   * @default false\n   */\n  onClearClick?: () => void\n  /**\n   * Primary handler for when the control is selected with pointer or keyboard events\n   */\n  onInteract?: () => void\n  /**\n   * Determines size of the size and spacing of the control.\n   *\n   * | 3xs     | 2xs     | xs      | sm      | md      | lg      | xl      | 2xl     | 3xl     |\n   * | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- | ------- |\n   * | `22px`  | `24px`  | `26px`  | `28px`  | `32px`  | `36px`  | `40px`  | `44px`  | `48px`  |\n   * @default md\n   */\n  size?: ControlSize\n  /**\n   * Displays loading indicator on top of button contents\n   * @default false\n   */\n  loading?: boolean\n  /**\n   * Icon displayed in the far right of the select trigger\n   * @default dropdown\n   */\n  dropdownIconType?: DropdownIconType\n  /** Icon displayed at the start of the control */\n  StartIcon?: React.ComponentType<React.SVGProps<SVGSVGElement>>\n  /** Custom class applied to the control element */\n  className?: string\n  /** Content rendered for the control */\n  children: ReactNode\n  ref?: React.Ref<HTMLSpanElement | null>\n}\n\nexport const SelectControl = ({\n  ref,\n  onPointerDown,\n  onKeyDown,\n  onPointerEnter,\n  onInteract,\n  invalid,\n  disabled,\n  children,\n  className,\n  variant = \"outline\",\n  size = \"md\",\n  block,\n  opticallyAlign,\n  pill = true,\n  loading,\n  onClearClick,\n  selected = false,\n  StartIcon,\n  dropdownIconType = \"dropdown\",\n  ...restProps\n}: SelectControlProps) => {\n  const controlRef = useRef<HTMLSpanElement>(null)\n  const clearable = !!onClearClick\n  const showClearAction = clearable && selected && !loading && !disabled\n  const hasDropdownIcon = dropdownIconType && dropdownIconType !== \"none\" && !loading\n  const hasAnyTertiaryIndicator = showClearAction || loading || hasDropdownIcon\n  const isInteractive = !loading && !disabled\n\n  // Act like a <button> and fire the click handler on keyboard actions\n  const handleKeyDown = (evt: React.KeyboardEvent<HTMLSpanElement>) => {\n    switch (evt.key) {\n      // NOTE: \"Enter\" does not open selects, as it may be an attempt to submit a form\n      case \"ArrowDown\":\n      case \"ArrowUp\":\n      case \" \":\n        evt.stopPropagation()\n        evt.preventDefault()\n\n        if (onInteract) {\n          onInteract()\n        } else {\n          // Otherwise, send a synthetic trigger event to Radix (presumably)\n          controlRef.current?.dispatchEvent(\n            new PointerEvent(\"pointerdown\", {\n              bubbles: true,\n              cancelable: true,\n              pointerType: \"mouse\", // mimic mouse interaction\n            }),\n          )\n        }\n        break\n      case \"Enter\":\n        // NOTE: \"Enter\" does not open selects, as it may be an attempt to submit a form\n        break\n      default:\n        // Allow all other key presses through\n        onKeyDown?.(evt)\n    }\n  }\n\n  const handlePointerDown = (evt: React.PointerEvent<HTMLSpanElement>) => {\n    // Don't trigger on right clicks\n    if (evt.button === 2) {\n      return\n    }\n\n    // Prevent focus from entering the click target of the select\n    // so that focus correctly moves into the menu.\n    evt.stopPropagation()\n\n    if (onInteract) {\n      evt.preventDefault()\n      onInteract()\n    } else {\n      // NOTE: cannot preventDefault() here, for radix\n      onPointerDown?.(evt)\n      // @ts-expect-error -- `onClick` can only be present if Radix is trying to spread it.\n      // An example would be `<Popover>`, but we specifically open this component on `onPointerDown`.\n      // Trigger the handler, assuming that `onPointerDown` is not going to be responsible for opening.\n      restProps.onClick?.(evt)\n    }\n  }\n\n  return (\n    // Intentionally not using <button> and rebuilding the semantics\n    <span\n      ref={mergeRefs([controlRef, ref])}\n      className={clsx(s.SelectControl, className)}\n      // Recreate <button> semantics\n      role=\"button\"\n      tabIndex={disabled ? -1 : 0}\n      onPointerEnter={(evt: React.PointerEvent<HTMLAnchorElement>) => {\n        handlePressableMouseEnter(evt)\n        onPointerEnter?.(evt)\n      }}\n      onPointerDown={isInteractive ? handlePointerDown : undefined}\n      onKeyDown={isInteractive ? handleKeyDown : undefined}\n      data-variant={variant}\n      data-block={block ? \"\" : undefined}\n      data-pill={pill ? \"\" : undefined}\n      data-size={size}\n      data-optically-align={opticallyAlign}\n      aria-busy={loading ? \"true\" : undefined}\n      data-selected={selected}\n      data-loading={loading ? \"\" : undefined}\n      data-invalid={invalid ? \"\" : undefined}\n      data-disabled={disabled ? \"\" : undefined}\n      aria-disabled={disabled}\n      {...restProps}\n      // Ignore onClick handler from Radix, because we use onPointerDown to mimic a native select\n      onClick={undefined}\n    >\n      {StartIcon && <StartIcon className={s.StartIcon} />}\n      <span className={s.TriggerText}>{children}</span>\n      {hasAnyTertiaryIndicator && (\n        <div className={s.IndicatorWrapper}>\n          {showClearAction && (\n            <Button\n              aria-label=\"Clear current value\"\n              className={s.Clear}\n              onPointerDown={(evt: React.PointerEvent<HTMLButtonElement>) => {\n                // Prevent pointerDown on trigger from being captured\n                evt.stopPropagation()\n              }}\n              onClick={(evt) => {\n                evt.stopPropagation()\n                evt.preventDefault()\n                onClearClick()\n              }}\n              color=\"secondary\"\n              variant={hasDropdownIcon ? \"ghost\" : \"solid\"}\n              // Mostly custom sizing through variables\n              size=\"3xs\"\n              uniform\n              pill={pill}\n              data-only-child={!hasDropdownIcon ? \"\" : undefined}\n            >\n              <X />\n            </Button>\n          )}\n          {loading && <LoadingIndicator className={s.LoadingIndicator} />}\n          {/* Using raw SVG canvases (opposed to fixed icon canvases) led to less pixelation. */}\n          {hasDropdownIcon && <DropdownIcon iconType={dropdownIconType} />}\n        </div>\n      )}\n    </span>\n  )\n}\n\ntype DropdownIconProps = {\n  iconType: Omit<DropdownIconType, \"none\">\n}\n\nexport const DropdownIcon = ({ iconType }: DropdownIconProps) => {\n  return iconType === \"chevronDown\" ? (\n    <ChevronDownVector className={clsx(s.DropdownIcon, s.DropdownIconChevron)} />\n  ) : (\n    <DropdownVector className={s.DropdownIcon} />\n  )\n}\n"]}