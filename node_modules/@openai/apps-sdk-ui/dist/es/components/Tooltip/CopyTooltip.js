"use client";
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { Tooltip as RadixTooltip } from "radix-ui";
import { useRef, useState } from "react";
import { copyText } from "../../lib/copyToClipboard";
import { Check, Copy } from "../Icon";
import { Tooltip } from "./Tooltip";
export const CopyTooltip = ({ children, copyValue, openDelay = 150, align = "center", alignOffset = 0, side = "top", sideOffset = 5, }) => {
    const [open, setOpen] = useState(false);
    const [copied, setCopied] = useState(false);
    const copiedTimerRef = useRef(undefined);
    const copy = () => {
        setCopied(true);
        // Not currently revealing the slight async nature of this operation,
        // nor indicating the failure state.
        copyText(copyValue);
        // Persist the copied state for a second, then close
        copiedTimerRef.current = setTimeout(() => {
            setOpen(false);
        }, 1000);
    };
    const handleOpenChange = (nextState) => {
        // When opening, ensure timer and copied state are cleared
        if (nextState) {
            clearTimeout(copiedTimerRef.current);
            setCopied(false);
        }
        setOpen(nextState);
    };
    return (_jsxs(Tooltip.Root, { open: open, onOpenChange: handleOpenChange, delayDuration: openDelay, disableHoverableContent: false, children: [_jsx(Tooltip.Trigger, { onPointerDown: (evt) => {
                    // Prevent tooltip listeners from closing
                    evt.preventDefault();
                    evt.stopPropagation();
                    // Copy the value
                    copy();
                }, 
                // Prevent default behavior of closing on click from this handler
                onClick: (evt) => {
                    evt.preventDefault();
                    evt.stopPropagation();
                }, children: children }), _jsx(Tooltip.Content, { compact: true, clickable: !copied, align: align, alignOffset: alignOffset, side: side, sideOffset: sideOffset, collisionPadding: 15, onEscapeKeyDown: () => setOpen(false), onPointerDown: copy, children: copied ? (
                // The <Check /> SVG canvas whitespace is larger than copy, so we use a smaller flexbox gap
                _jsxs("div", { className: "flex items-center gap-0.5", children: [_jsx(Check, {}), " Copied!"] })) : (_jsxs("div", { className: "flex items-center gap-1", children: [_jsx(Copy, {}), " Copy"] })) })] }));
};
//# sourceMappingURL=CopyTooltip.js.map