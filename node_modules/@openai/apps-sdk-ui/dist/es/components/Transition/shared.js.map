{"version":3,"file":"shared.js","sourceRoot":"","sources":["../../../../src/components/Transition/shared.ts"],"names":[],"mappings":"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","sourcesContent":["import React, { Children, useCallback, useRef } from \"react\"\nimport { isDev, isTest } from \"../../lib/constants\"\n\nexport type TransitionDefinition = {\n  opacity?: number\n  /** The horizontal translation value in pixels */\n  x?: number\n  /**  The horizontal vertical value in pixels */\n  y?: number\n  /** The opacity value ranging from 0 to 1. */\n  scale?: number\n  rotate?: number | string\n  skewX?: number | string\n  skewY?: number | string\n  blur?: number\n  duration?: number\n  delay?: number\n  timingFunction?: string\n}\n\nexport type InitialTransitionDefinition = Omit<\n  TransitionDefinition,\n  \"duration\" | \"delay\" | \"timingFunction\"\n>\n\nexport type LayoutTransitionDefinition = {\n  duration?: number\n  delay?: number\n  timingFunction?: string\n}\n\nexport type CallbackType =\n  | \"enter\"\n  | \"enter-active\"\n  | \"enter-complete\"\n  | \"exit\"\n  | \"exit-active\"\n  | \"exit-complete\"\n\n// Transition callbacks and types shared across implementations\nexport type TransitionGroupChildCallback = (element: HTMLDivElement) => void\n\nexport type TransitionGroupChildCallbacks = {\n  /** Callback fired when an enter animation is staged (e.g., component mounted to the DOM) */\n  onEnter: TransitionGroupChildCallback\n  /** Callback fired when an enter animation starts */\n  onEnterActive: TransitionGroupChildCallback\n  /** Callback fired when an enter animation completes */\n  onEnterComplete: TransitionGroupChildCallback\n  /** Callback fired when an exit animation is staged */\n  onExit: TransitionGroupChildCallback\n  /** Callback fired when an exit animation starts */\n  onExitActive: TransitionGroupChildCallback\n  /** Callback fired when an exit animation completes (e.g., component unmounted from the DOM) */\n  onExitComplete: TransitionGroupChildCallback\n}\n\nexport const NonNullChildren = (children: React.ReactNode) =>\n  Children.toArray(children).filter((child) => child !== null && child !== undefined)\n\n// Shared keyed-children and transition helpers\nexport interface ReactElementWithKey extends React.ReactElement {\n  key: string\n}\n\nexport const ChildrenWithKeys = (\n  children: React.ReactNode,\n  shouldThrow: boolean = false,\n  componentName: string = \"TransitionGroup\",\n): ReactElementWithKey[] => {\n  const validChildren: ReactElementWithKey[] = []\n  Children.forEach(children, (child) => {\n    if (child && typeof child === \"object\" && \"key\" in child && !!child.key) {\n      // @ts-expect-error -- The above conditional is enough coercion that the component is valid\n      validChildren.push(child)\n    } else if (shouldThrow) {\n      throw new Error(`Child elements of <${componentName} /> must include a \\`key\\``)\n    }\n  })\n  return validChildren\n}\n\nexport const noop = () => {}\n\nexport const useChildCallback = (cb: (el: HTMLDivElement) => void) => {\n  const ref = useRef(cb)\n  ref.current = cb\n  return useCallback<(el: HTMLDivElement) => void>((element) => ref.current(element), [])\n}\n\nexport type InsertMethod = \"append\" | \"prepend\"\n\nexport function computeNextRenderChildren<\n  RenderChild extends { component: ReactElementWithKey; shouldRender: boolean },\n>(\n  propChildrenArray: ReactElementWithKey[],\n  currentRenderChildren: RenderChild[],\n  createDefaultRenderChildProps: (child: ReactElementWithKey) => RenderChild,\n  insertMethod: InsertMethod,\n): RenderChild[] {\n  const propChildKeyMap = propChildrenArray.reduce<Record<string, number>>(\n    (acc, child) => ({ ...acc, [child.key]: 1 }),\n    {},\n  )\n  const currentRenderChildKeyMap = currentRenderChildren.reduce<Record<string, number>>(\n    (acc, child) => ({ ...acc, [child.component.key]: 1 }),\n    {},\n  )\n\n  const newRenderChildren: RenderChild[] = propChildrenArray\n    .filter((propChild) => !currentRenderChildKeyMap[propChild.key])\n    .map(createDefaultRenderChildProps)\n\n  const updatedCurrentChildren: RenderChild[] = currentRenderChildren.map((childProps) => ({\n    ...childProps,\n    component:\n      propChildrenArray.find(({ key }) => key === childProps.component.key) || childProps.component,\n    shouldRender: !!propChildKeyMap[childProps.component.key],\n  }))\n\n  return insertMethod === \"append\"\n    ? updatedCurrentChildren.concat(newRenderChildren)\n    : newRenderChildren.concat(updatedCurrentChildren)\n}\n\nexport function assertSingleChildWhenRef(\n  componentName: string,\n  ref: React.Ref<unknown> | undefined,\n  childrenCount: number,\n): void {\n  if ((isTest || isDev) && ref && childrenCount > 1) {\n    throw new Error(`Cannot use forwardRef with multiple children in <${componentName} />`)\n  }\n}\n"]}