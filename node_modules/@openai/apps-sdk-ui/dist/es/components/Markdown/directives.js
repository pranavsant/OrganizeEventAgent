import {} from "react";
import { visit } from "unist-util-visit";
import { createId } from "../../lib/ids";
import { decodeBase64, encodeBase64 } from "../../lib/safeBase64";
export function createMarkdownDirective({ render, name, mode, }) {
    const prefix = `OaiMdDirective_${name}`;
    const uniqueName = createId(prefix, prefix.length + 6);
    function directive(props) {
        const { children, ...attributes } = props;
        const attrs = Object.keys(attributes).length >= 0 ? `attrs="${encodeBase64(attributes)}"` : "";
        const leader = mode === "inline" ? " :" : "\n\n:::";
        return `${leader}${uniqueName}${children ? `[${children}]` : ""}{${attrs}}`;
    }
    directive.directiveName = uniqueName;
    directive.render = ({ children, attrs }) => {
        const parsedAttrs = attrs ? decodeBase64(attrs) : {};
        return render({ ...parsedAttrs, children });
    };
    return directive;
}
export function reactMarkdownRemarkDirective() {
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    return (tree) => {
        visit(tree, ["textDirective", "leafDirective", "containerDirective"], (node) => {
            node.data = {
                hName: node.name,
                hProperties: node.attributes,
                ...node.data,
            };
            return node;
        });
    };
}
//# sourceMappingURL=directives.js.map