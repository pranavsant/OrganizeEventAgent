{"version":3,"file":"Trigger.js","sourceRoot":"","sources":["../../../../src/components/DateRangePicker/Trigger.tsx"],"names":[],"mappings":"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","sourcesContent":["\"use client\"\n\nimport clsx from \"clsx\"\nimport type { DateTime } from \"luxon\"\nimport { useMemo, type ComponentProps } from \"react\"\nimport { getMonthStartAndEnd, isBefore, isSameDay } from \"../../lib/dateUtils\"\nimport { Button } from \"../Button\"\nimport { Calendar, ChevronLeft, ChevronRight } from \"../Icon\"\nimport { SelectControl } from \"../SelectControl\"\nimport s from \"./Trigger.module.css\"\nimport { useDateRangeContext } from \"./context\"\nimport { type DateRange, type DateRangeShortcut } from \"./types\"\n\nexport const DateRangeTrigger = (props: ComponentProps<\"span\">) => {\n  const {\n    value,\n    min,\n    max,\n    disabled,\n    variant,\n    pill,\n    size,\n    block,\n    triggerStepperUnit,\n    triggerClassName,\n    clearable,\n    dropdownIconType,\n    triggerShowIcon,\n    onChangeRef,\n  } = useDateRangeContext()\n\n  const isStepperView = useMemo<boolean>(\n    () =>\n      rangeMatchesStepperUnit(value, triggerStepperUnit, {\n        min,\n        max,\n      }),\n    [value, triggerStepperUnit, min, max],\n  )\n\n  const handleClearClick = () => {\n    onChangeRef.current(null)\n  }\n\n  return (\n    <SelectControl\n      className={clsx(isStepperView && s.StepperControl, triggerClassName)}\n      selected={!!value}\n      variant={variant}\n      pill={pill}\n      block={block}\n      size={size}\n      disabled={disabled}\n      StartIcon={triggerShowIcon && !isStepperView ? Calendar : undefined}\n      dropdownIconType={!isStepperView ? dropdownIconType : \"none\"}\n      onClearClick={clearable && !isStepperView ? handleClearClick : undefined}\n      {...props}\n    >\n      {isStepperView ? <TriggerStepperView /> : <TriggerDisplayView />}\n    </SelectControl>\n  )\n}\n\nconst TriggerStepperView = () => {\n  const { value, min, max, disabled, onChangeRef } = useDateRangeContext()\n\n  if (!value) {\n    return null\n  }\n\n  const [startDate, endDate] = value\n  const canGoBack = !min || isBefore(min, startDate.startOf(\"month\"))\n  const canGoForward = !max || isBefore(endDate.endOf(\"month\"), max)\n\n  return (\n    <span className=\"flex\">\n      <Button\n        className={s.StepperPrevious}\n        color=\"secondary\"\n        variant=\"ghost\"\n        disabled={disabled || !canGoBack}\n        size=\"3xs\"\n        uniform\n        pill\n        onPointerDown={(evt) => {\n          evt.stopPropagation()\n          onChangeRef.current(getMonthStartAndEnd(startDate.minus({ months: 1 }), { min, max }))\n        }}\n      >\n        <ChevronLeft />\n      </Button>{\" \"}\n      <span className={clsx(s.TriggerText, \"min-w-[120px] text-center\")}>\n        {startDate.monthLong} {startDate.year}\n      </span>\n      <Button\n        className={s.StepperNext}\n        color=\"secondary\"\n        variant=\"ghost\"\n        disabled={disabled || !canGoForward}\n        size=\"3xs\"\n        uniform\n        pill\n        onPointerDown={(evt) => {\n          evt.stopPropagation()\n          onChangeRef.current(getMonthStartAndEnd(startDate.plus({ months: 1 }), { min, max }))\n        }}\n      >\n        <ChevronRight />\n      </Button>\n    </span>\n  )\n}\n\nconst TriggerDisplayView = () => {\n  const { placeholder, value, triggerDateFormat, shortcuts } = useDateRangeContext()\n\n  const activeShortcut = useMemo<DateRangeShortcut | undefined>(() => {\n    if (!value || !shortcuts?.length) {\n      return undefined\n    }\n\n    return shortcuts.find((sc) => {\n      const [start, end] = sc.getDateRange()\n      return isSameDay(start, value[0]) && isSameDay(end, value[1])\n    })\n  }, [value, shortcuts])\n\n  return (\n    <>\n      {activeShortcut ? (\n        <span className=\"inline-block\">{activeShortcut.label}</span>\n      ) : value && isSameDay(value[0], value[1]) ? (\n        <span className=\"inline-block tabular-nums\">{value[0].toFormat(triggerDateFormat)}</span>\n      ) : value ? (\n        <span className=\"inline-block tabular-nums\">\n          {value[0].toFormat(triggerDateFormat)}\n          <span className={s.RangeTextSeparator}>-</span>\n          {value[1].toFormat(triggerDateFormat)}\n        </span>\n      ) : (\n        placeholder\n      )}\n    </>\n  )\n}\n\nconst rangeMatchesStepperUnit = (\n  range: DateRange | null,\n  stepperUnit: \"month\" | undefined,\n  { min, max }: { min?: DateTime; max?: DateTime } = {},\n): boolean => {\n  // Allows method to be called lazily\n  if (!range || !stepperUnit) {\n    return false\n  }\n\n  const [startDate, endDate] = range\n  const [startDateCompare, endDateCompare] = getMonthStartAndEnd(startDate, {\n    min,\n    max,\n  })\n\n  return isSameDay(startDateCompare, startDate) && isSameDay(endDateCompare, endDate)\n}\n"]}