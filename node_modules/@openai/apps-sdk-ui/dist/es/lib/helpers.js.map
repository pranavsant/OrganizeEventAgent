{"version":3,"file":"helpers.js","sourceRoot":"","sources":["../../../src/lib/helpers.ts"],"names":[],"mappings":"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","sourcesContent":["import { type CSSProperties } from \"react\"\nimport { canUseDOM, hasDocument, hasWindow } from \"./environment\"\nimport type { Pretty } from \"./utilityTypes\"\n\nexport const prefersReducedMotion = () => {\n  if (!hasWindow || typeof window.matchMedia !== \"function\") {\n    return false\n  }\n\n  return window.matchMedia(\"(prefers-reduced-motion: reduce)\").matches\n}\n\nexport const handlePressableMouseEnter = (evt: React.MouseEvent) => {\n  const target = evt.currentTarget\n\n  // Safely coerce type to HTMLElement so TS is peaceful with `evt.target`\n  if (!(target instanceof HTMLElement)) {\n    return\n  }\n\n  const elementWidth = target.offsetWidth\n\n  let scale = 0.985\n\n  if (elementWidth <= 80) {\n    scale = 0.96\n  } else if (elementWidth <= 150) {\n    scale = 0.97\n  } else if (elementWidth <= 220) {\n    scale = 0.98\n  } else if (elementWidth > 600) {\n    scale = 0.995\n  }\n\n  target.style.setProperty(\"--scale\", scale.toString())\n}\n\ninterface CancelAnimationFrame {\n  (): void\n}\n\nexport const waitForAnimationFrame = (\n  cb: () => void,\n  options?: { frames: number },\n): CancelAnimationFrame => {\n  const runAfterTick = () => {\n    const id = setTimeout(cb)\n    return () => {\n      clearTimeout(id)\n    }\n  }\n\n  if (!canUseDOM || typeof window.requestAnimationFrame !== \"function\") {\n    return runAfterTick()\n  }\n\n  const visibilityHidden = hasDocument && document.visibilityState === \"hidden\"\n  if (visibilityHidden) {\n    return runAfterTick()\n  }\n\n  let frames = options?.frames ?? 2\n  let animationFrame = window.requestAnimationFrame(function recurse() {\n    frames -= 1\n    if (frames === 0) {\n      cb()\n    } else {\n      animationFrame = window.requestAnimationFrame(recurse)\n    }\n  })\n\n  return () => {\n    if (typeof window.cancelAnimationFrame === \"function\") {\n      window.cancelAnimationFrame(animationFrame)\n    }\n  }\n}\n\nexport const toCssVariables = (\n  variables: Record<string, string | number | undefined>,\n): CSSProperties => {\n  const formattedVariables = Object.keys(variables).reduce(\n    (acc, variable) => {\n      // Ensure value is truthy\n      const value = variables[variable]\n      // Accept 0 as a valid value\n      if (value || value === 0) {\n        // Add the prefix if it wasn't already provided\n        const prefix = variable.startsWith(\"--\") ? \"\" : \"--\"\n        const formattedValue = typeof value === \"number\" ? `${value}px` : value\n\n        acc[`${prefix}${variable}`] = formattedValue\n      }\n\n      return acc\n    },\n    {} as Record<string, string>,\n  )\n\n  // Safe casting because we know we've formatted an object of CSS Variable strings\n  return formattedVariables as CSSProperties\n}\n\nexport const toAngle = (value: number | string): string =>\n  typeof value === \"number\" ? `${value}deg` : value\n\nexport const toOpacityProperty = (opacity: number): string => String(opacity)\n\nexport const toMsDurationProperty = (duration: number): string => `${duration}ms`\n\nexport const toTransformProperty = ({\n  x,\n  y,\n  scale,\n  rotate,\n  skewX,\n  skewY,\n}: {\n  x?: number\n  y?: number\n  scale?: number\n  rotate?: number | string\n  skewX?: number | string\n  skewY?: number | string\n} = {}): string => {\n  const transforms = [\n    x == null ? null : `translateX(${x}px)`,\n    y == null ? null : `translateY(${y}px)`,\n    scale == null ? null : `scale(${scale})`,\n    rotate == null ? null : `rotate(${toAngle(rotate)})`,\n    skewX == null ? null : `skewX(${toAngle(skewX)})`,\n    skewY == null ? null : `skewY(${toAngle(skewY)})`,\n  ].filter(Boolean)\n\n  return transforms.length ? transforms.join(\" \") : \"none\"\n}\n\nexport const toFilterProperty = ({ blur }: { blur?: number | undefined } = {}) => {\n  // Maybe add more support in the future\n  const filters = [blur == null ? null : `blur(${blur}px)`].filter(Boolean)\n\n  return filters.length ? filters.join(\" \") : \"none\"\n}\n\nexport const preventDefaultHandler = (evt: Event) => {\n  evt.preventDefault()\n}\n\n/*\n * Intentionally simple selector string. Purposeful exclusions: (for now)\n * - select, because our selects are better recognized as button\n * - unused selectors like iframe, object, .etc.\n * - states like [inert]\n */\nexport const focusableElements = (element: HTMLElement) =>\n  element.querySelectorAll<HTMLElement>(\n    'a[href], input:not([disabled]):not([type=\"hidden\"]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex^=\"-\"]), [contenteditable]',\n  )\n\nexport const sleep = (ms: number): Promise<void> =>\n  new Promise((resolve) => setTimeout(resolve, ms))\n\n/**\n * Group an array of objects by a property, preserving the *first-seen* order\n * of each group.\n *\n * @example\n * groupByOrdered(people, \"team\")\n * // => [ { team: \"infra\", items:[...] }, { team:\"design\", items:[...] }, ... ]\n */\nexport function groupByProperty<T extends object, K extends keyof T, F = T[K]>(\n  items: T[],\n  key: K,\n  format: (raw: T[K], item: T) => F = (raw) => raw as F,\n) {\n  const groups: Pretty<{ [P in K]: F } & { items: T[] }>[] = []\n  const indexMap = new Map<unknown, number>() // maps group value -> index in groups array\n\n  for (const item of items) {\n    const value = format(item[key], item)\n\n    // Add to existing group\n    const existing = indexMap.get(value)\n    if (existing !== undefined) {\n      groups[existing].items.push(item)\n      continue\n    }\n\n    // Create new group\n    const group = { [key]: value, items: [item] } as { [P in K]: F } & { items: T[] }\n    indexMap.set(value, groups.length)\n    groups.push(group)\n  }\n\n  return groups\n}\n"]}