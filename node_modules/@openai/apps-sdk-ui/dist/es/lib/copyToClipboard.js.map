{"version":3,"file":"copyToClipboard.js","sourceRoot":"","sources":["../../../src/lib/copyToClipboard.ts"],"names":[],"mappings":"AAOA,MAAM,qBAAqB,GAAG,GAAY,EAAE,CAC1C,OAAO,aAAa,KAAK,WAAW,IAAI,CAAC,CAAC,SAAS,CAAC,SAAS,EAAE,KAAK,CAAA;AAEtE,iEAAiE;AACjE,MAAM,UAAU,eAAe,CAAC,OAAyB;IACvD,MAAM,EAAE,YAAY,EAAE,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,OAAO,CAAA;IAC/C,OAAO,IAAI,aAAa,CAAC;QACvB,GAAG,IAAI;QACP,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,YAAY,EAAE,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,EAAE,YAAY,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;KAC9E,CAAC,CAAA;AACJ,CAAC;AAED;;;;;;;;;;GAUG;AACH,MAAM,CAAC,KAAK,UAAU,eAAe,CACnC,OAAkC,EAClC,YAAyB,QAAQ,CAAC,IAAI;IAEtC,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE,CAAC;QAChC,OAAO,QAAQ,CAAC,OAAO,EAAE,SAAS,CAAC,CAAA;IACrC,CAAC;IAED,IAAI,CAAC;QACH,IAAI,qBAAqB,EAAE,EAAE,CAAC;YAC5B,MAAM,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC,CAAC,CAAA;YAC3D,OAAO,IAAI,CAAA;QACb,CAAC;QAED,uDAAuD;QACvD,IAAI,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC;YAC1B,OAAO,QAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,SAAS,CAAC,CAAA;QACnD,CAAC;QAED,OAAO,KAAK,CAAA;IACd,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,KAAK,CAAA;IACd,CAAC;AACH,CAAC;AAED;;;;;;;;;;GAUG;AACH,MAAM,CAAC,KAAK,UAAU,QAAQ,CAC5B,IAAY,EACZ,YAAyB,QAAQ,CAAC,IAAI;IAEtC,IAAI,SAAS,CAAC,SAAS,EAAE,CAAC;QACxB,IAAI,CAAC;YACH,kDAAkD;YAClD,MAAM,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAA;YACzC,OAAO,IAAI,CAAA;QACb,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,uDAAuD;YACvD,eAAe;QACjB,CAAC;IACH,CAAC;IAED,kBAAkB;IAClB,MAAM,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAA;IACnD,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAA;IAErB,+BAA+B;IAC/B,QAAQ,CAAC,KAAK,CAAC,QAAQ,GAAG,OAAO,CAAA;IACjC,QAAQ,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAA;IACxB,QAAQ,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAA;IACzB,QAAQ,CAAC,KAAK,CAAC,OAAO,GAAG,GAAG,CAAA;IAE5B,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAA;IAC/B,QAAQ,CAAC,KAAK,EAAE,CAAA;IAChB,QAAQ,CAAC,MAAM,EAAE,CAAA;IAEjB,IAAI,SAAS,GAAG,KAAK,CAAA;IACrB,IAAI,CAAC;QACH,SAAS,GAAG,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,CAAA;IAC1C,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,SAAS;IACX,CAAC;IACD,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAA;IAC/B,OAAO,SAAS,CAAA;AAClB,CAAC","sourcesContent":["export type ClipboardContent = {\n  \"text/plain\"?: string\n  \"image/png\"?: Blob\n  \"image/jpeg\"?: Blob\n  \"image/webp\"?: Blob\n}\n\nconst supportsRichClipboard = (): boolean =>\n  typeof ClipboardItem !== \"undefined\" && !!navigator.clipboard?.write\n\n// Convert ClipboardContent to { [mime]: Blob } for ClipboardItem\nexport function toClipboardItem(content: ClipboardContent): ClipboardItem {\n  const { \"text/plain\": text, ...rest } = content\n  return new ClipboardItem({\n    ...rest,\n    ...(text ? { \"text/plain\": new Blob([text], { type: \"text/plain\" }) } : null),\n  })\n}\n\n/**\n * Utility for copying rich content in a cross-browser way\n *\n * @param {string | ClipboardContent} content\n * @param {HTMLElement} container - Fallback text copy method requires appending a textarea\n *   to the DOM and focusing it. If you don't want to shift focus out of the currently\n *   focused container (e.g. a popover) you can specify a custom container to append\n *   the textarea to keep focus in that container. This need for this edge case is\n *   exceedingly rare as navigator.clipboard.writeText support expands.\n * @returns - A promise that resolves to true if the copy was successful, false otherwise.\n */\nexport async function copyToClipboard(\n  content: string | ClipboardContent,\n  container: HTMLElement = document.body,\n): Promise<boolean> {\n  if (typeof content === \"string\") {\n    return copyText(content, container)\n  }\n\n  try {\n    if (supportsRichClipboard()) {\n      await navigator.clipboard.write([toClipboardItem(content)])\n      return true\n    }\n\n    // Fallback: if we have plain text, at least copy that.\n    if (content[\"text/plain\"]) {\n      return copyText(content[\"text/plain\"], container)\n    }\n\n    return false\n  } catch (error) {\n    return false\n  }\n}\n\n/**\n * Utility for copying plaintext in a cross-browser way\n *\n * @param {string} text\n * @param {HTMLElement} container - Fallback text copy method requires appending a textarea\n *   to the DOM and focusing it. If you don't want to shift focus out of the currently\n *   focused container (e.g. a popover) you can specify a custom container to append\n *   the textarea to keep focus in that container. This need for this edge case is\n *   exceedingly rare as navigator.clipboard.writeText support expands.\n * @returns - A promise that resolves to true if the copy was successful, false otherwise.\n */\nexport async function copyText(\n  text: string,\n  container: HTMLElement = document.body,\n): Promise<boolean> {\n  if (navigator.clipboard) {\n    try {\n      // Try to use the navigator.clipboard method first\n      await navigator.clipboard.writeText(text)\n      return true\n    } catch (error) {\n      // If that doesn't work, we continue on to the fallback\n      // method below\n    }\n  }\n\n  // Fallback method\n  const textArea = document.createElement(\"textarea\")\n  textArea.value = text\n\n  // Avoid visibility/interaction\n  textArea.style.position = \"fixed\"\n  textArea.style.top = \"0\"\n  textArea.style.left = \"0\"\n  textArea.style.opacity = \"0\"\n\n  container.appendChild(textArea)\n  textArea.focus()\n  textArea.select()\n\n  let succeeded = false\n  try {\n    succeeded = document.execCommand(\"copy\")\n  } catch (error) {\n    // Ignore\n  }\n  container.removeChild(textArea)\n  return succeeded\n}\n"]}