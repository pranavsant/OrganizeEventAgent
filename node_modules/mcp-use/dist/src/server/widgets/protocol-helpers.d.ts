/**
 * Protocol Helper Functions
 *
 * Shared utilities for dual-protocol metadata building and widget URI generation.
 * Reduces duplication in ui-resource-registration.ts
 */
import { McpAppsAdapter } from "./adapters/mcp-apps.js";
import { AppsSdkAdapter } from "./adapters/apps-sdk.js";
import type { UIResourceDefinition } from "../types/resource.js";
/**
 * Create singleton instances of protocol adapters
 */
export declare function createProtocolAdapters(): {
    mcpApps: McpAppsAdapter;
    appsSdk: AppsSdkAdapter;
};
/**
 * Build dual-protocol metadata for both MCP Apps and Apps SDK
 *
 * @param definition - UI resource definition
 * @param uri - Resource URI
 * @param existingMetadata - Optional existing metadata to merge with
 * @returns Combined metadata object with both protocols
 */
export declare function buildDualProtocolMetadata(definition: UIResourceDefinition, uri: string, existingMetadata?: Record<string, unknown>): Record<string, unknown>;
/**
 * Build MCP Apps resource metadata with CSP, prefersBorder, domain etc.
 *
 * Per MCP Apps spec (SEP-1865), these fields belong on the resource _meta.ui,
 * not on the tool definition.
 *
 * For dual-protocol (mcpApps), ui.csp is derived from the same source as
 * openai/widgetCSP so both tool and resource have identical CSP.
 *
 * @param definition - UI resource definition
 * @returns Resource metadata with _meta.ui containing CSP etc.
 */
export declare function buildResourceUiMeta(definition: UIResourceDefinition): Record<string, unknown> | undefined;
/**
 * Generate unique widget URI with random ID suffix
 *
 * @param name - Widget name
 * @param buildId - Optional build ID
 * @param extension - File extension (default: ".html")
 * @returns Unique widget URI
 */
export declare function generateUniqueWidgetUri(name: string, buildId: string | undefined, extension?: string): string;
/**
 * Generate tool output content with resource reference
 *
 * @param definition - UI resource definition
 * @param params - Tool parameters
 * @param displayName - Display name for the widget
 * @returns Tool output with content array
 */
export declare function generateToolOutput(definition: UIResourceDefinition, params: Record<string, unknown>, displayName: string): {
    content: Array<{
        type: string;
        text?: string;
        resource?: {
            uri: string;
            mimeType?: string;
        };
    }>;
    structuredContent?: unknown;
};
/**
 * Get resource URI and MIME type based on definition type
 *
 * @param definition - UI resource definition
 * @param buildId - Optional build ID
 * @returns Object with uri and mimeType
 */
export declare function getResourceUriAndMimeType(definition: UIResourceDefinition, buildId: string | undefined): {
    uri: string;
    mimeType: string;
};
/**
 * Detect schema type from props or schema
 *
 * @param propsOrSchema - Props definition or schema object
 * @returns Detected schema type and the schema itself
 */
export declare function detectSchemaType(propsOrSchema: unknown): {
    type: "zod" | "json" | "widgetProps" | null;
    schema: unknown;
};
/**
 * Copy specific metadata fields from source to target
 *
 * @param source - Source metadata object
 * @param target - Target metadata object
 * @param fields - Fields to copy
 */
export declare function copyMetadataFields(source: Record<string, unknown> | undefined, target: Record<string, unknown>, fields: readonly string[]): void;
/**
 * Deep merge UI metadata objects
 *
 * @param existing - Existing metadata
 * @param incoming - Incoming metadata to merge
 * @returns Merged metadata or undefined if both are empty
 */
export declare function deepMergeUiMetadata(existing: Record<string, unknown> | undefined, incoming: Record<string, unknown> | undefined): Record<string, unknown> | undefined;
/**
 * Get build ID suffix for URIs
 *
 * @param buildId - Optional build ID
 * @returns Build ID part (e.g., "-abc123" or "")
 */
export declare function getBuildIdPart(buildId: string | undefined): string;
//# sourceMappingURL=protocol-helpers.d.ts.map